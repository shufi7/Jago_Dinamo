<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnosis Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <header class="bg-light py-3 border-bottom text-center">
        <h1>Diagnosis Dinamo</h1>
        <button class="btn btn-primary mt-2">Mulai Diagnosa</button>
    </header>

    <div class="container my-5">
        <div class="row">
            <div class="col-md-4 text-center">
                <img src="https://via.placeholder.com/150" alt="Gambar Diagnosa" class="img-fluid">
            </div>
            <div class="col-md-8">
                <h2>Form Diagnosis</h2>
                <div id="quiz-container"></div>
                <button class="btn btn-success mt-3" onclick="hitungDiagnosa()">Submit Jawaban</button>
                <div class="mt-4">
                    <h4>Hasil Diagnosis:</h4>
                    <p id="hasil"></p>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-light py-3 border-top text-center">
        <p class="mb-0">Footer</p>
    </footer>

    <script>
        const dataSoal = [
            {
                soal: "Apakah dinamo starter berputar dengan lambat saat menyalakan mobil?",
                pilihan: [
                    { jawaban: "Ya, sangat lambat", poin: { aki: 1, brush: 1 } },
                    { jawaban: "Lambat tapi masih bisa", poin: { aki: 1 } },
                    { jawaban: "Normal", poin: {} },
                    { jawaban: "Tidak berputar sama sekali", poin: { dinamo: 2 } }
                ]
            },
            {
                soal: "Apakah terdengar suara klik saat kunci kontak diputar?",
                pilihan: [
                    { jawaban: "Ya, tapi tidak menyala", poin: { solenoid: 2 } },
                    { jawaban: "Klik berkali-kali", poin: { aki: 1 } },
                    { jawaban: "Tidak ada suara", poin: { kabel: 1 } },
                    { jawaban: "Langsung menyala", poin: {} }
                ]
            },
            {
                soal: "Apakah lampu dashboard redup saat mencoba menyalakan?",
                pilihan: [
                    { jawaban: "Ya, sangat redup", poin: { aki: 2 } },
                    { jawaban: "Sedikit redup", poin: { aki: 1 } },
                    { jawaban: "Tetap terang", poin: {} },
                    { jawaban: "Tidak menyala sama sekali", poin: { sekring: 1 } }
                ]
            },
            {
                soal: "Apakah pernah mencium bau terbakar dari mesin saat menyalakan?",
                pilihan: [
                    { jawaban: "Ya, sering", poin: { lilitan: 2 } },
                    { jawaban: "Kadang-kadang", poin: { lilitan: 1 } },
                    { jawaban: "Tidak pernah", poin: {} },
                    { jawaban: "Tidak yakin", poin: {} }
                ]
            },
            {
                soal: "Apakah dinamo terdengar mendengung tetapi mesin tidak menyala?",
                pilihan: [
                    { jawaban: "Ya, sering terjadi", poin: { brush: 2 } },
                    { jawaban: "Kadang-kadang", poin: { brush: 1 } },
                    { jawaban: "Tidak pernah", poin: {} },
                    { jawaban: "Tidak tahu", poin: {} }
                ]
            },
            {
                soal: "Apakah terdapat kabel yang terlihat meleleh atau terbakar?",
                pilihan: [
                    { jawaban: "Ya, jelas terlihat", poin: { kabel: 2 } },
                    { jawaban: "Sedikit saja", poin: { kabel: 1 } },
                    { jawaban: "Tidak ada", poin: {} },
                    { jawaban: "Belum diperiksa", poin: {} }
                ]
            },
            {
                soal: "Apakah suara starter terdengar berat dan lambat?",
                pilihan: [
                    { jawaban: "Ya, berat sekali", poin: { dinamo: 2 } },
                    { jawaban: "Agak berat", poin: { dinamo: 1 } },
                    { jawaban: "Normal", poin: {} },
                    { jawaban: "Tidak terdengar suara", poin: { solenoid: 1 } }
                ]
            },
            {
                soal: "Apakah fuse atau sekring pernah putus saat starter digunakan?",
                pilihan: [
                    { jawaban: "Ya, sering putus", poin: { sekring: 2 } },
                    { jawaban: "Pernah sekali dua kali", poin: { sekring: 1 } },
                    { jawaban: "Tidak pernah", poin: {} },
                    { jawaban: "Tidak yakin", poin: {} }
                ]
            }
        ];

        const hasilPoin = {
            aki: 0,
            brush: 0,
            dinamo: 0,
            solenoid: 0,
            kabel: 0,
            sekring: 0,
            lilitan: 0
        };

        const container = document.getElementById("quiz-container");
        dataSoal.forEach((q, i) => {
            const div = document.createElement("div");
            div.classList.add("mb-3");
            div.innerHTML = `<p><strong>${i + 1}. ${q.soal}</strong></p>`;
            q.pilihan.forEach((opt, j) => {
                div.innerHTML += `
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="soal${i}" id="soal${i}_pilihan${j}" value='${JSON.stringify(opt.poin)}'>
                        <label class="form-check-label" for="soal${i}_pilihan${j}">${opt.jawaban}</label>
                    </div>`;
            });
            container.appendChild(div);
        });

        function hitungDiagnosa() {
            const totalSoal = dataSoal.length;
            const radiosChecked = document.querySelectorAll("input[type='radio']:checked").length;
            if (radiosChecked < totalSoal) {
                alert(`Silakan jawab semua pertanyaan terlebih dahulu. Masih ada ${totalSoal - radiosChecked} pertanyaan yang belum dijawab.`);
                return;
            }
            const radios = document.querySelectorAll("input[type='radio']:checked");
            let hasil = {...hasilPoin};
            radios.forEach(r => {
                const poin = JSON.parse(r.value);
                for (let key in poin) {
                    hasil[key] += poin[key];
                }
            });
            let max = 0;
            let kerusakan = "Tidak terdeteksi kerusakan yang spesifik";
            for (let k in hasil) {
                if (hasil[k] > max) {
                    max = hasil[k];
                    kerusakan = `Kemungkinan kerusakan pada: ${k}`;
                }
            }
            const estimasiBiaya = {
                aki: 300000,
                brush: 150000,
                dinamo: 800000,
                solenoid: 250000,
                kabel: 100000,
                sekring: 50000,
                lilitan: 400000
            };

            let biaya = 0;
            if (estimasiBiaya[kerusakan.split(': ')[1]]) {
                biaya = estimasiBiaya[kerusakan.split(': ')[1]];
                kerusakan += `
Estimasi biaya perbaikan: Rp ${biaya.toLocaleString('id-ID')}`;
            }

            document.getElementById("hasil").innerText = kerusakan;
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
